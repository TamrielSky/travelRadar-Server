"use strict";angular.module("instaPlaceApp",["ngAnimate","ngAria","ngCookies","ngMessages","ngResource","ngSanitize","ngTouch","uiGmapgoogle-maps","ui.router","uiRouterStyles","ngAutocomplete","ui.bootstrap-slider","ngStorage","ui-listView","angular-loading-bar"]).config(["$stateProvider","$urlRouterProvider",function(a,b){b.otherwise("/welcome"),a.state("home",{url:"/home",views:{"":{templateUrl:"views/home.html",controller:"homeCtrl",controllerAs:"homePage"},"autocompleteView@home":{templateUrl:"views/autocomplete.html",controller:"autocompleteCtrl",controllerAs:"autocomplete"},"listView@home":{templateUrl:"views/listView.html",controller:"listCtrl"},"mapView@home":{templateUrl:"views/mapView.html",controller:"mapsCtrl",controllerAs:"mapConfig"},"placeDescribeView@home":{templateUrl:"views/describePlace.html"}},params:{source:null,destination:null,filter:null}}).state("welcome",{url:"/welcome",views:{"":{templateUrl:"views/main.html",controller:"mainCtrl",controllerAs:"main"},"placeIconView@welcome":{templateUrl:"views/placeIconView.html",controller:"placeIconCtrl",controllerAs:"placeIconCtrl"}}}).state("about",{url:"/about",templateUrl:"views/about.html"})}]),angular.module("instaPlaceApp").controller("mapsCtrl",["$localStorage","$scope",function(a,b){this.windowOptions={visible:!1};var c=[{featureType:"all",stylers:[{saturation:-80}]},{featureType:"road.arterial",elementType:"geometry",stylers:[{hue:"#00ffee"},{saturation:50}]},{featureType:"poi.business",elementType:"labels",stylers:[{visibility:"off"}]}];b.options={styles:c},this.currentLocationMarker={options:{icon:{url:"../images/blue_dot_circle.c9ce3a8b.png"}}},this.markers={gas_station:{options:{icon:{url:"../images/gas_station-marker.644471ef.png",scaledSize:new google.maps.Size(30,35)}}},restaurant:{options:{icon:{url:"../images/restaurant-marker.3014fe28.png",scaledSize:new google.maps.Size(30,35)}}},atm:{options:{icon:{url:"../images/atm-marker.d83ece56.png",scaledSize:new google.maps.Size(30,35)}}},bar:{options:{icon:{url:"../images/bar-marker.4c8b97ab.png",scaledSize:new google.maps.Size(30,35)}}},grocery:{options:{icon:{url:"../images/grocery-marker.6ae28011.png",scaledSize:new google.maps.Size(30,35)}}},airport:{options:{icon:{url:"../images/atm-marker.d83ece56.png",scaledSize:new google.maps.Size(30,35)}}},hospital:{options:{icon:{url:"../images/hospital-marker.98a43f08.png",scaledSize:new google.maps.Size(30,35)}}}}}]),angular.module("instaPlaceApp").controller("homeCtrl",["routeBoxerService","geolocationService","placeFilterService","$localStorage","$scope","uiGmapIsReady","$interval","$stateParams",function(a,b,c,d,e,f,g,h){function i(){var a=$(".mainview").height()-$(".autocomplete").height();$(".angular-google-map-container").height(a),$(".ui-list-view").height(a-$(".mainListView").height())}var j=this,k=new google.maps.DirectionsRenderer({suppressMarkers:!0}),l=new google.maps.DirectionsService;j.loadingStyle={visibility:"hidden"},j.routeBoxes=[],j.mapZoom=14,j.filteredPlaces=null,j.normalizedPlaces=[],j.markers=[],j.searchFilter=[],j.infoWindow={show:!1,name:null,address:null,coords:null},j.gmapCircle={visible:!0,stroke:{color:"#DC381F",weight:1,opacity:.1},fill:{color:"#DC381F",opacity:.1},control:{}},this.setLocation=function(){this.sourceLocation=this.currentAddress,this.sourceLocationCoords=this.currentLocation.coords},this.setLoadingVisible=function(a){a?j.loadingStyle.visibility="visible":j.loadingStyle.visibility="hidden"},this.searchNearByPlaces=function(d,e,f){if(j.searchFilter&&j.searchFilter.length<1&&(j.searchFilter=f),!j.searchFilter||j.searchFilter.length<1)alert("Please select location filter");else{j.filteredPlaces=[],j.markers=[],j.setLoadingVisible(!0);var g=(Promise.resolve(),[]);g.push(b.getLatLngFromAddress(d)),g.push(b.getLatLngFromAddress(e)),Promise.all(g).then(function(d){var e={origin:d[0],destination:d[1],travelMode:"DRIVING"};l.route(e,function(d,e){if("OK"==e){var f=a.routeBoxer.box(d.routes[0].overview_path,.3);f.forEach(function(a){var b=new google.maps.Rectangle({visible:!1,strokeColor:"#FF0000",strokeOpacity:.8,strokeWeight:2,fillColor:"#FF0000",fillOpacity:.35,map:j.map,bounds:{north:a.getNorthEast().lat(),south:a.getSouthWest().lat(),east:a.getNorthEast().lng(),west:a.getSouthWest().lng()}});j.routeBoxes.push(b)}),k.setMap(j.map),b.getPlacesAlongRoute(f,j.searchFilter).then(function(a){j.filteredPlaces=c.filterPlacesByBounds(a.data,f),j.setupMarkers(),j.setLoadingVisible(!1),k.setDirections(d),j.bindSourceAndDestinationCoords(j.sourceLocation,j.destinationLocation)},function(a){console.log(a)})}})})}},this.sortPlaces=function(a,b){var d=angular.copy(j.filteredPlaces);j.filteredPlaces=[],b?j.filteredPlaces=c.sortByProperty(d,a).reverse():j.filteredPlaces=c.sortByProperty(d,a),this.setupMarkers()},this.filterPlacesByRadius=function(a,b){var c=[];j.filteredPlaces=[],j.markers=[];for(var d=j.normalizedPlaces,e=0,f=0;f<d.length;f++)b>d[f].distance&&(c[e]=d[f],e++);j.filteredPlaces=c,this.setupMarkers()},this.setupMarkers=function(){for(var a=0;a<j.filteredPlaces.length;a++)j.markers.push({info:{address:j.filteredPlaces[a].address,name:j.filteredPlaces[a].name},id:j.filteredPlaces[a].place_id+","+a,coords:{latitude:j.filteredPlaces[a].location.latitude,longitude:j.filteredPlaces[a].location.longitude},key:j.markers.length+1,filter:j.filteredPlaces[a].filter})},this.clickListItem=function(a){for(var b=0;b<j.filteredPlaces.length;b++)j.filteredPlaces[b].selected=!1;a.selected=!a.selected,this.openInfoWindowFromList(a)},this.openInfoWindow=function(a){j.infoWindow.coords={latitude:a.position.lat(),longitude:a.position.lng()};var b=a.key.split(",")[1];j.infoWindow.name=j.filteredPlaces[b].name,j.infoWindow.address=j.filteredPlaces[b].address,j.infoWindow.show=!0},this.openInfoWindowFromList=function(a){j.infoWindow.coords={latitude:a.location.latitude,longitude:a.location.longitude};for(var b=0;b<j.filteredPlaces.length;b++)if(j.filteredPlaces[b].place_id==a.place_id){j.infoWindow.name=j.filteredPlaces[b].name,j.infoWindow.address=j.filteredPlaces[b].address,j.infoWindow.show=!0;break}},this.markerEvents={click:function(a){j.infoWindow.show=!0,j.openInfoWindow(a);var b=a.key.split(",")[0];angular.element("#"+b).triggerHandler("click")}},this.setIconConfig=function(a){this.placeIconWidth=a+"px",this.placeIconHeight=a+"px",this.top="14px",this.background_size="contain",this.position="relative",this.box_shadow="3px 3px 2px 2px rgba(0, 0, 0, 0.4)",this.display="inline-block"},this.showRouteBoxes=function(a){for(var b=0;b<this.routeBoxes.length;b++)this.routeBoxes[b].setVisible(a)},this.bindSourceAndDestinationCoords=function(a,c){var d=[];d.push(b.getLatLngFromAddress(a)),d.push(b.getLatLngFromAddress(c)),Promise.all(d).then(function(a){this.sourceLocationCoords={latitude:a[0].lat(),longitude:a[0].lng()},this.destinationLocationCoords={latitude:a[1].lat(),longitude:a[1].lng()}}.bind(this))},this.mapsInitialisedPromise=f.promise().then(function(a){this.map=a[0].map}.bind(this)),h.source&&h.destination?(this.sourceLocation=h.source,this.destinationLocation=h.destination,this.filter=h.filter,b.getLatLngFromAddress(this.sourceLocation).then(function(a){a={coords:{latitude:a.lat(),longitude:a.lng()}},this.location=a,i(),this.mapsInitialisedPromise.then(function(){this.searchNearByPlaces(this.sourceLocation,this.destinationLocation,this.filter)}.bind(this))}.bind(this))):b.getLocation().then(function(a){return a={coords:{latitude:a.coords.latitude,longitude:a.coords.longitude}},j.location=a,j.currentLocation=angular.copy(j.location),i(),b.getAddress(j.location.coords)}).then(function(a){j.currentAddress=a,e.$apply()})}]),angular.module("instaPlaceApp").controller("listCtrl",["$scope",function(a){a.Math=window.Math,a.selectedItem=!1}]),angular.module("instaPlaceApp").controller("mainCtrl",["$state","geolocationService",function(a,b){this.updateLocation=function(){var a=this;b.getLocation().then(function(c){c={coords:{latitude:c.coords.latitude,longitude:c.coords.longitude}},a.location=c,b.getAddress(a.location.coords).then(function(b){a.locationAddress=b})})},this.searchPlacesAlongRoute=function(b,c){!this.searchFilter||this.searchFilter.length<1?alert("Please select/click place filters before a search"):(console.log("source"+b+"   destination:"+c),a.go("home",{source:b,destination:c,filter:this.searchFilter}))},this.setLocation=function(){this.locationAddress&&(this.source=this.locationAddress)},this.setIconConfig=function(a){this.placeIconWidth=a+"px",this.placeIconHeight=a+"px",this.top="0px",this.background_size="contain",this.position="relative",this.box_shadow="3px 3px 2px 2px rgba(0, 0, 0, 0.4)",this.display="inline-block"},this.updateLocation()}]),angular.module("instaPlaceApp").controller("AboutCtrl",function(){this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}),angular.module("instaPlaceApp").controller("autocompleteCtrl",function(){this.place="",this.filterArray=[],this.placeIcons=[{name:"restaurant",boxShadow:"3px 3px 2px 2px rgba(0, 0, 0, 0.4)"},{name:"atm",boxShadow:"3px 3px 2px 2px rgba(0, 0, 0, 0.4)"},{name:"bar",boxShadow:"3px 3px 2px 2px rgba(0, 0, 0, 0.4)"},{name:"hospital",boxShadow:"3px 3px 2px 2px rgba(0, 0, 0, 0.4)"},{name:"grocery",boxShadow:"3px 3px 2px 2px rgba(0, 0, 0, 0.4)"},{name:"gas_station",boxShadow:"3px 3px 2px 2px rgba(0, 0, 0, 0.4)"}],this.addFilter=function(a,b){for(var a=a.split("-")[0],c="",d=0;d<this.placeIcons.length;d++)if(this.placeIcons[d].name.split("-")[0]==a){var e=this.filterArray.indexOf(a);-1==e?(c="inset 0 0 10px rgba(0, 0, 0, 0.8)",this.placeIcons[d].name=this.placeIcons[d].name+"-selected",this.filterArray.push(a)):(c="3px 3px 2px 2px rgba(0, 0, 0, 0.4)",this.placeIcons[d].name=this.placeIcons[d].name.split("-")[0],this.filterArray.splice(e,1)),this.placeIcons[d].boxShadow=c}b.searchFilter=this.filterArray},this.filterPlaces=function(a,b,c){for(var d=0;d<c.length;d++)1609*b<c[d].distance&&c.splice(d,1);console.log("changed")}}),angular.module("instaPlaceApp").service("geolocationService",["$http",function(a){this.yelpApi="http://api.yelp.com/v2/search/?",this.fourSquareApi="https://api.foursquare.com/v2/venues/explore?",this.categoryMap={foursquare:{restaurant:"4bf58dd8d48988d1c4941735",grocery:"4bf58dd8d48988d118951735",bar:"4bf58dd8d48988d116941735",airport:"4bf58dd8d48988d1ed931735",hospital:"4bf58dd8d48988d196941735",atm:"52f2ab2ebcbc57f1066b8b56",gas_station:"4bf58dd8d48988d113951735"},yelp:{restaurant:"restaurants",grocery:"grocery",bar:"bars",airport:"airports",hospital:"hospitals",atm:"atm",gas_station:"servicestations"}},this.getLocation=function(){return new Promise(function(a,b){navigator.geolocation?navigator.geolocation.getCurrentPosition(function(b){a(b)},function(){b("error")}):b("error")})},this.getAddress=function(a){var b=this;return new Promise(function(c,d){var e=new google.maps.Geocoder;e.geocode({location:{lat:a.latitude,lng:a.longitude}},function(a,e){e===google.maps.GeocoderStatus.OK&&a[0]?(b.currentAddress=a[0].formatted_address,c(a[0].formatted_address)):d("error")})})},this.getLatLngFromAddress=function(a){return new Promise(function(b,c){var d=new google.maps.Geocoder;d.geocode({address:a},function(a,c){b(c===google.maps.GeocoderStatus.OK?a[0].geometry.location:"error")})})},this.getAllPlaceDetailsById=function(a){var b=this,c=[];return new Promise(function(d,e){var f=Promise.resolve();a.forEach(function(a){f=f.then(function(){return b.getPlaceDetailsById(a.place_id,a.geometry.location.lat(),a.geometry.location.lng())}).then(function(a){c.push(a)})["catch"](function(a){console.log(a)})}),f.then(function(){d(c)})})},this.getPlaceDetailsById=function(a,b,c){return new Promise(function(d,e){var f=new google.maps.Map(document.getElementById("map"),{center:{lat:b,lng:c},zoom:15}),g=new google.maps.places.PlacesService(f),h={placeId:a};g.getDetails(h,function(a,b){b==google.maps.places.PlacesServiceStatus.OK?d(a):(alert(b),d("error"))})})},this.calculateAndDisplayRoute=function(a,b){return new Promise(function(c,d){var e=new google.maps.DirectionsService;e.route({origin:a,destination:b,travelMode:google.maps.TravelMode.DRIVING},function(a,b){b===google.maps.DirectionsStatus.OK?c(a):(alert(b),c("error"))})})},this.getPlacesAlongRoute=function(b,c){var d={url:"https://ec2-54-153-12-214.us-west-1.compute.amazonaws.com:443/search",method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:[b,c]};return a(d)}}]),angular.module("instaPlaceApp").service("placeFilterService",["$http",function(a){this.filterPlaces=function(a,b){var c=[],d=0;for(var e in a)for(var f=a[e],g=0;g<f.length;g++)if("[object Object]"===Object.prototype.toString.call(f[g]))if(f[g].config.url.includes("yelp"))for(var h=0;h<f[g].data.businesses.length;h++){c[d]={},c[d].distance=(.000621371192*f[g].data.businesses[h].distance).toFixed(2),c[d].name=f[g].data.businesses[h].name,c[d].contact=f[g].data.businesses[h].display_phone,c[d].rating=f[g].data.businesses[h].rating?f[g].data.businesses[h].rating:0,c[d].review=f[g].data.businesses[h].snippet_text;for(var i=[],j=0;j<f[g].data.businesses[h].location.display_address.length;j++)i.push(f[g].data.businesses[h].location.display_address[j]);i=i.join(),c[d].address=i,c[d].location=f[g].data.businesses[h].location.coordinate,c[d].datasrc="yelp",c[d].place_id=f[g].data.businesses[h].id,c[d].filter=e,c[d].selected=!1,d++}else for(var k=f[g].data.response.groups[0].items,h=0;h<k.length;h++){c[d]={};var l=k[h].venue;c[d].distance=(.000621371192*l.location.distance).toFixed(2);for(var i=[],j=0;j<l.location.formattedAddress.length;j++)i.push(l.location.formattedAddress[j]);i=i.join(),c[d].address=i,c[d].rating=l.rating?5*l.rating/10:0,c[d].name=l.name,c[d].location={latitude:l.location.lat,longitude:l.location.lng},c[d].contact=l.contact.formattedPhone,k[h].tips&&(c[d].review=k[h].tips[0].text),c[d].datasrc="foursquare",c[d].filter=e,c[d].place_id=l.id,c[d].selected=!1,d++}else for(var m=f[g],j=0;j<m.length;j++){c[d]={};var n=m[j];c[d].rating=n.rating?n.rating:0,c[d].name=n.name,c[d].location={latitude:n.geometry.location.lat(),longitude:n.geometry.location.lng()},c[d].distance=(.000621371192*this.calcDistance(b.coords.latitude,b.coords.longitude,n.geometry.location.lat(),n.geometry.location.lng())).toFixed(2),c[d].address=n.vicinity,c[d].datasrc="google",c[d].filter=e,c[d].place_id=n.id,c[d].selected=!1,d++}return c},this.eliminateDuplicates=function(a){for(var b=[],c=[],d=0,e=0;e<a.length;e++)b[a[e].distance+","+a[e].name]?a[e].rating&&a[e].review&&(b[a[e].distance+","+a[e].name]=a[e]):b[a[e].distance+","+a[e].name]=a[e];for(var f in b)c[d++]=b[f];return c},this.calcDistance=function(a,b,c,d){function e(a){return a*(Math.PI/180)}var f=6371,g=e(c-a),h=e(d-b),i=Math.sin(g/2)*Math.sin(g/2)+Math.cos(e(a))*Math.cos(e(c))*Math.sin(h/2)*Math.sin(h/2),j=2*Math.atan2(Math.sqrt(i),Math.sqrt(1-i)),k=f*j;return 1e3*k},this.sortByProperty=function(a,b){return a.sort(function(a,c){return a[b]==c[b]?0:a[b]<c[b]?-1:1})},this.filterPlacesByBounds=function(a,b){var c=[];return b.forEach(function(b){for(var d=0;d<a.length;d++){var e=new google.maps.LatLng(a[d].location.latitude,a[d].location.longitude),f=new google.maps.LatLng(b.getSouthWest().lat(),b.getSouthWest().lng()),g=new google.maps.LatLng(b.getNorthEast().lat(),b.getNorthEast().lng()),h=new google.maps.LatLngBounds(f,g);h.contains(e)&&c.push(a[d])}}),c}}]),angular.module("instaPlaceApp").service("routeBoxerService",function(){function a(){this.R=6371}a.prototype.box=function(a,b){this.grid_=null,this.latGrid_=[],this.lngGrid_=[],this.boxesX_=[],this.boxesY_=[];var c=null;if(a instanceof Array)c=a;else if(a instanceof google.maps.Polyline)if(a.getPath){c=new Array(a.getPath().getLength());for(var d=0;d<c.length;d++)c[d]=a.getPath().getAt(d)}else{c=new Array(a.getVertexCount());for(var e=0;e<c.length;e++)c[e]=a.getVertex(e)}return this.buildGrid_(c,b),this.findIntersectingCells_(c),this.mergeIntersectingCells_(),this.boxesX_.length<=this.boxesY_.length?this.boxesX_:this.boxesY_},a.prototype.buildGrid_=function(a,b){for(var c=new google.maps.LatLngBounds,d=0;d<a.length;d++)c.extend(a[d]);var e=c.getCenter();for(this.latGrid_.push(e.lat()),this.latGrid_.push(e.rhumbDestinationPoint(0,b).lat()),d=2;this.latGrid_[d-2]<c.getNorthEast().lat();d++)this.latGrid_.push(e.rhumbDestinationPoint(0,b*d).lat());for(d=1;this.latGrid_[1]>c.getSouthWest().lat();d++)this.latGrid_.unshift(e.rhumbDestinationPoint(180,b*d).lat());for(this.lngGrid_.push(e.lng()),this.lngGrid_.push(e.rhumbDestinationPoint(90,b).lng()),d=2;this.lngGrid_[d-2]<c.getNorthEast().lng();d++)this.lngGrid_.push(e.rhumbDestinationPoint(90,b*d).lng());for(d=1;this.lngGrid_[1]>c.getSouthWest().lng();d++)this.lngGrid_.unshift(e.rhumbDestinationPoint(270,b*d).lng());for(this.grid_=new Array(this.lngGrid_.length),d=0;d<this.grid_.length;d++)this.grid_[d]=new Array(this.latGrid_.length)},a.prototype.findIntersectingCells_=function(a){var b=this.getCellCoords_(a[0]);this.markCell_(b);for(var c=1;c<a.length;c++){var d=this.getGridCoordsFromHint_(a[c],a[c-1],b);(d[0]!==b[0]||d[1]!==b[1])&&(1===Math.abs(b[0]-d[0])&&b[1]===d[1]||b[0]===d[0]&&1===Math.abs(b[1]-d[1])?this.markCell_(d):this.getGridIntersects_(a[c-1],a[c],b,d),b=d)}},a.prototype.getCellCoords_=function(a){for(var b=0;this.lngGrid_[b]<a.lng();b++);for(var c=0;this.latGrid_[c]<a.lat();c++);return[b-1,c-1]},a.prototype.getGridCoordsFromHint_=function(a,b,c){var d,e;if(a.lng()>b.lng())for(d=c[0];this.lngGrid_[d+1]<a.lng();d++);else for(d=c[0];this.lngGrid_[d]>a.lng();d--);if(a.lat()>b.lat())for(e=c[1];this.latGrid_[e+1]<a.lat();e++);else for(e=c[1];this.latGrid_[e]>a.lat();e--);return[d,e]},a.prototype.getGridIntersects_=function(a,b,c,d){var e,f,g,h=a.rhumbBearingTo(b),i=a,j=c;if(b.lat()>a.lat()){for(g=c[1]+1;g<=d[1];g++)e=this.getGridIntersect_(a,h,this.latGrid_[g]),f=this.getGridCoordsFromHint_(e,i,j),this.fillInGridSquares_(j[0],f[0],g-1),i=e,j=f;this.fillInGridSquares_(j[0],d[0],g-1)}else{for(g=c[1];g>d[1];g--)e=this.getGridIntersect_(a,h,this.latGrid_[g]),f=this.getGridCoordsFromHint_(e,i,j),this.fillInGridSquares_(j[0],f[0],g),i=e,j=f;this.fillInGridSquares_(j[0],d[0],g)}},a.prototype.getGridIntersect_=function(a,b,c){var d=this.R*((c.toRad()-a.lat().toRad())/Math.cos(b.toRad()));return a.rhumbDestinationPoint(b,d)},a.prototype.fillInGridSquares_=function(a,b,c){var d;if(b>a)for(d=a;b>=d;d++)this.markCell_([d,c]);else for(d=a;d>=b;d--)this.markCell_([d,c])},a.prototype.markCell_=function(a){var b=a[0],c=a[1];this.grid_[b-1][c-1]=1,this.grid_[b][c-1]=1,this.grid_[b+1][c-1]=1,this.grid_[b-1][c]=1,this.grid_[b][c]=1,this.grid_[b+1][c]=1,this.grid_[b-1][c+1]=1,this.grid_[b][c+1]=1,this.grid_[b+1][c+1]=1},a.prototype.mergeIntersectingCells_=function(){var a,b,c,d=null;for(b=0;b<this.grid_[0].length;b++){for(a=0;a<this.grid_.length;a++)this.grid_[a][b]?(c=this.getCellBounds_([a,b]),d?d.extend(c.getNorthEast()):d=c):(this.mergeBoxesY_(d),d=null);this.mergeBoxesY_(d),d=null}for(a=0;a<this.grid_.length;a++){for(b=0;b<this.grid_[0].length;b++)this.grid_[a][b]?d?(c=this.getCellBounds_([a,b]),d.extend(c.getNorthEast())):d=this.getCellBounds_([a,b]):(this.mergeBoxesX_(d),d=null);this.mergeBoxesX_(d),d=null}},a.prototype.mergeBoxesX_=function(a){if(null!==a){for(var b=0;b<this.boxesX_.length;b++)if(this.boxesX_[b].getNorthEast().lng()===a.getSouthWest().lng()&&this.boxesX_[b].getSouthWest().lat()===a.getSouthWest().lat()&&this.boxesX_[b].getNorthEast().lat()===a.getNorthEast().lat())return void this.boxesX_[b].extend(a.getNorthEast());this.boxesX_.push(a)}},a.prototype.mergeBoxesY_=function(a){if(null!==a){for(var b=0;b<this.boxesY_.length;b++)if(this.boxesY_[b].getNorthEast().lat()===a.getSouthWest().lat()&&this.boxesY_[b].getSouthWest().lng()===a.getSouthWest().lng()&&this.boxesY_[b].getNorthEast().lng()===a.getNorthEast().lng())return void this.boxesY_[b].extend(a.getNorthEast());this.boxesY_.push(a)}},a.prototype.getCellBounds_=function(a){return new google.maps.LatLngBounds(new google.maps.LatLng(this.latGrid_[a[1]],this.lngGrid_[a[0]]),new google.maps.LatLng(this.latGrid_[a[1]+1],this.lngGrid_[a[0]+1]))},google.maps.LatLng.prototype.rhumbDestinationPoint=function(a,b){var c=6371,d=parseFloat(b)/c,e=this.lat().toRad(),f=this.lng().toRad();a=a.toRad();var g=e+d*Math.cos(a),h=g-e,i=Math.log(Math.tan(g/2+Math.PI/4)/Math.tan(e/2+Math.PI/4)),j=Math.abs(h)>1e-10?h/i:Math.cos(e),k=d*Math.sin(a)/j;Math.abs(g)>Math.PI/2&&(g=g>0?Math.PI-g:-(Math.PI-g));var l=(f+k+Math.PI)%(2*Math.PI)-Math.PI;return isNaN(g)||isNaN(l)?null:new google.maps.LatLng(g.toDeg(),l.toDeg())},google.maps.LatLng.prototype.rhumbBearingTo=function(a){var b=(a.lng()-this.lng()).toRad(),c=Math.log(Math.tan(a.lat().toRad()/2+Math.PI/4)/Math.tan(this.lat().toRad()/2+Math.PI/4));return Math.abs(b)>Math.PI&&(b=b>0?-(2*Math.PI-b):2*Math.PI+b),Math.atan2(b,c).toBrng()},Number.prototype.toRad=function(){return this*Math.PI/180},Number.prototype.toDeg=function(){return 180*this/Math.PI},Number.prototype.toBrng=function(){return(this.toDeg()+360)%360},this.routeBoxer=new a}),angular.module("instaPlaceApp").controller("placeIconCtrl",function(){this.place="",this.filterArray=[],this.placeIcons=[{title:"Restaurant",name:"restaurant",boxShadow:"3px 3px 2px 2px rgba(0, 0, 0, 0.4)"},{title:"ATM",name:"atm",boxShadow:"3px 3px 2px 2px rgba(0, 0, 0, 0.4)"},{title:"Bar",name:"bar",boxShadow:"3px 3px 2px 2px rgba(0, 0, 0, 0.4)"},{title:"Hospital",name:"hospital",boxShadow:"3px 3px 2px 2px rgba(0, 0, 0, 0.4)"},{title:"Grocery",name:"grocery",boxShadow:"3px 3px 2px 2px rgba(0, 0, 0, 0.4)"},{title:"Gas",name:"gas_station",boxShadow:"3px 3px 2px 2px rgba(0, 0, 0, 0.4)"}],this.addFilter=function(a,b){for(var a=a.split("-")[0],c="",d=0;d<this.placeIcons.length;d++)if(this.placeIcons[d].name.split("-")[0]==a){var e=this.filterArray.indexOf(a);-1==e?(c="inset 0 0 10px rgba(0, 0, 0, 0.8)",this.placeIcons[d].name=this.placeIcons[d].name+"-selected",this.filterArray.push(a)):(c="3px 3px 2px 2px rgba(0, 0, 0, 0.4)",this.placeIcons[d].name=this.placeIcons[d].name.split("-")[0],this.filterArray.splice(e,1)),this.placeIcons[d].boxShadow=c}b.searchFilter=this.filterArray}}),angular.module("instaPlaceApp").run(["$templateCache",function(a){a.put("views/autocomplete.html",'<div class="container" id="toolbar"> <ul class="toolbar-panel"> <li> <div class="round-button" ng-click="homePage.setLocation()"></div> </li> <li><input type="text" placeholder="Where are you at " ng-model="homePage.sourceLocation" class="searchBox" ng-autocomplete ng-model="autocomplete" options="options" details="details"></li> <li><input type="text" placeholder="Where are you going" ng-model="homePage.destinationLocation" class="searchBox" ng-autocomplete ng-model="autocomplete" options="options" details="details"></li> <li><button type="button" class="btn btn-danger gradient-button" ng-click="homePage.searchNearByPlaces(homePage.sourceLocation, homePage.destinationLocation)">Search</button></li> <div class="filters" ng-repeat="placeIcon in autocomplete.placeIcons"> <div class="{{placeIcon.name}}" style="width: 40px;\n    height: 40px;\n    top: 14px;\n    background-size: contain;\n    position: relative;\n    box-shadow: 3px 3px 2px 2px rgba(0, 0, 0, 0.4); display: inline-block; background-image: url(\'../images/{{placeIcon.name}}.png\'); box-shadow: {{placeIcon.boxShadow}}" ng-click="autocomplete.addFilter(placeIcon.name, homePage)"></div> </div> </ul> </div>'),a.put("views/describePlace.html",'<div class="detailPanel" ng-if="homePage.place"> <div class="row"> <img class="parallel-div" id="place-icon" ng-src="{{homePage.place.icon}}"> <div class="parallel-div" id="place-name">{{homePage.place.name}}</div> </div> <div class="row"> <div class="detail">{{homePage.place.formatted_address}}</div> </div> <div class="row"> <p>{{homePage.place.rating}}</p> </div> <div class="row"> <div class="col-md-4 text-center" id="infoBox"> <div class="row"> <div class="glyphicon glyphicon-earphone"></div> </div> <div class="row">{{homePage.place.formatted_phone_number}}</div> </div> <div class="col-md-4" id="infoBox"></div> <div class="col-md-4" id="infoBox"></div>  </div> </div>'),a.put("views/home.html",'<div class="overlay-loader" ng-style="homePage.loadingStyle"> <div class="loader"> </div> </div> <div class="row autocomplete"> <div ui-view="autocompleteView"></div> </div> <div class="row"> <!-- COLUMN ONE NAMED VIEW --> <div class="col-sm-3 listWrapper"> <div ui-view="listView" class="mainListView"></div> </div> <!-- COLUMN ONE NAMED VIEW --> <div class="col-sm-9 mapWrapper"> <div ui-view="mapView"></div> </div> </div>'),a.put("views/listView.html",'<div class="contact-list panel panel-default"> <div class="panel-heading"> <div class="dropdown"> <button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">Sort <span class="caret"></span> </button> <ul class="dropdown-menu" aria-labelledby="dropdownMenu1"> <li><a ng-click="homePage.sortPlaces(\'rating\', true)">Popularity</a></li> <li><a ng-click="homePage.sortPlaces(\'distance\', false)">Distance</a></li> </ul> </div> <input class="form-control" ng-model="search.name" placeholder="Search place.."> </div> <div class="panel-body"> <div class="ui-list-view-bordered" ui-list-view="place in homePage.filteredPlaces | filter:search"> <div id="{{place.place_id}}" ng-click="homePage.clickListItem(place, place.selected); place.selected" ng-class="{selected: place.selected}"> <div class="place">{{place.name}}<span class="filter-icon"><img src="../images/{{place.filter}}-mini.png" width="30px"></span></div> <div ng-if="place.rating" class="stars"> <img src="../images/{{Math.floor(place.rating)}}{{Math.round(place.rating)}}stars.png"> </div> <div class="address" id="{{place.place_id}}">{{place.address}}</div> <div style="display: inline-block" ng-if="place.selected && place.review"><img class="comment" src="../images/comment.9bb21441.png"><span class="review">{{place.review}}</span></div> </div> </div> </div> </div>'),a.put("views/main.html",'<div class="col-md-11" style="height: 100%"> <div class="row"> <div class="main-title"> <img ng-src="../images/globe.8d68ea5b.png" width="250px"> <h1>Travel Radar</h1> </div> </div> <div class="row" style="height: 100%"> <div class="centering text-center"> <!-- <ul class="center-panel">\n\n        <li><input type="text" placeholder="location" /></li>\n        <li><input type="text" placeholder="Enter a location" /></li>\n        <li><button type="button" class="btn btn-danger" ng-click="main.searchNearByPlaces()">Search</button></li>\n\n    </ul> --> <div class="col-md-2"> <div class="centering location-button" style="height: 65px; width: 65px" ng-click="main.setLocation()"></div> </div> <div class="col-md-4"> <input class="input-left" type="text" placeholder="Where are you at" ng-model="main.source" ng-autocomplete ng-model="autocomplete" options="options" details="details"> </div> <div class="col-md-4"> <input class="input-right" type="text" placeholder="Where are you going" ng-model="main.destination" ng-autocomplete ng-model="autocomplete" options="options" details="details"> </div> <div class="col-md-2"> <button type="button" ng-click="main.searchPlacesAlongRoute(main.source, main.destination)">Search</button> </div> </div> </div> </div> <div class="col-md-1" style="height: 100%"> <div style="position: relative; height: 100%; top: 15%" ui-view="placeIconView" ng-init="main.setIconConfig(55)"> </div> </div>'),a.put("views/mapView.html",'<div class="checkbox-container"> <div class="checkbox" style="padding: 5px"> <label> <input type="checkbox" ng-model="homePage.checked" value="homePage.checked" ng-change="homePage.showRouteBoxes(homePage.checked)"> Show route boxes </label> </div> </div> <ui-gmap-google-map id="mymap" center="homePage.location.coords" zoom="homePage.mapZoom" options="options"> <div ng-if="homePage.sourceLocation"> <ui-gmap-circle center="homePage.sourceLocationCoords" stroke="homePage.gmapCircle.stroke" fill="homePage.gmapCircle.fill" radius="1" visible control="homePage.gmapCircle.control"></ui-gmap-circle> <ui-gmap-marker coords="homePage.sourceLocationCoords" options="mapConfig.currentLocationMarker.options" idkey="0"> </ui-gmap-marker> </div> <div ng-if="homePage.destinationLocation"> <ui-gmap-circle center="homePage.destinationLocationCoords" stroke="homePage.gmapCircle.stroke" fill="homePage.gmapCircle.fill" radius="1" visible control="homePage.gmapCircle.control"></ui-gmap-circle> <ui-gmap-marker coords="homePage.destinationLocationCoords" options="mapConfig.currentLocationMarker.options" idkey="0"> </ui-gmap-marker> </div> <ui-gmap-window closeclick="closeClick()" show="homePage.infoWindow.show" coords="homePage.infoWindow.coords"> <div class="infoWindow"> <div id="title">{{homePage.infoWindow.name}}</div> <div id="info">{{homePage.infoWindow.address}}</div> </div> </ui-gmap-window> <ui-gmap-marker ng-repeat="m in homePage.markers" coords="m.coords" idkey="m.id" options="mapConfig.markers[m.filter]" events="homePage.markerEvents"> </ui-gmap-marker> </ui-gmap-google-map>'),a.put("views/placeIconView.html",'<div class="filters" ng-repeat="placeIcon in placeIconCtrl.placeIcons"> <div class="{{placeIcon.name}}" style="width: {{main.placeIconWidth}};\n    height: {{main.placeIconHeight}};\n    top: {{main.top}};\n    background-size: contain;\n    position: relative;\n    margin-top: 10px;\n    box-shadow: 3px 3px 2px 2px rgba(0, 0, 0, 0.4);\n\n display: {{main.display}}; background-image: url(\'../images/{{placeIcon.name}}.png\'); box-shadow: {{placeIcon.boxShadow}}" ng-click="placeIconCtrl.addFilter(placeIcon.name, main)"></div> <div class="icon-title"> {{placeIcon.title}}</div> </div>')}]);